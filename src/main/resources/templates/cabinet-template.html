<div th:fragment="loading" class="preloader flex-column justify-content-center align-items-center">
    <img class="animation__wobble" th:src="@{/images/logo.png}" alt="AdminLTELogo" height="60" width="60">
</div>
<!-- Navbar -->
<nav th:fragment="header" class="main-header navbar navbar-expand navbar-white navbar-light align-items-center">
    <!-- Left navbar links -->
    <ul class="navbar-nav align-items-center">
        <li class="nav-item">
            <a class="nav-link" data-widget="pushmenu" href="#" role="button" style="padding-top: 10px;"><i class="fas fa-bars"></i></a>
        </li>
        <li class="nav-item d-none d-sm-inline-block" style="padding-top:2px;">
            <h7 th:text="#{personalCab}">Личный кабинет</h7>
        </li>
    </ul>
    <!-- Right navbar links -->
    <aside class="navbar-nav ml-auto align-items-center">
        <div class="my-lang mr-2">
            <svg th:if="${#locale.language == 'uk'}" style="width:20px" xmlns="http://www.w3.org/2000/svg"
                 enable-background="new 0 0 30 20" viewBox="0 0 30 20" id="ukraine-flag">
                <rect width="30" height="20"></rect>
                <rect width="28" height="9" x="1" y="1" fill="#005bbb"></rect>
                <rect width="28" height="9" x="1" y="10" fill="#ffd500"></rect>
            </svg>
            <svg th:if="${#locale.language == 'ru'}" style="width:20px" xmlns="http://www.w3.org/2000/svg"
                 viewBox="0 0 47.5 47.5" id="pig">
                <defs>
                    <clipPath id="a">
                        <path d="M0 38h38V0H0v38Z"></path>
                    </clipPath>
                </defs>
                <g clip-path="url(#a)" transform="matrix(1.25 0 0 -1.25 0 47.5)">
                    <path fill="#f4abba"
                          d="M35.193 23.67a6.01 6.01 0 0 1 1.02 1.28c1.685 2.853.269 10.292-.592 10.8-.696.411-5.53-1.05-8.246-3.132-2.499 1.497-5.344 2.381-8.375 2.381-3.022 0-5.856-.879-8.349-2.367-2.721 2.075-7.533 3.528-8.227 3.118-.861-.508-2.276-7.947-.592-10.8.278-.471.615-.884.989-1.249C1.665 21.149 1 18.359 1 15.521 1 5.531 9.01 2.999 19 2.999c9.989 0 18 2.532 18 12.522 0 2.827-.661 5.606-1.807 8.149"></path>
                    <path fill="#ea596e"
                          d="M8.398 31.035c-2.166 1.268-4.402 2.08-4.8 1.845-.57-.336-1.083-4.998-.351-8.264a20.366 20.366 0 0 0 5.151 6.419M34.753 24.616c.732 3.267.219 7.928-.351 8.265-.398.235-2.634-.578-4.8-1.846a20.316 20.316 0 0 0 5.151-6.419M29 13.875C29 9.388 25.903 4.5 19 4.5c-6.904 0-10 4.888-10 9.375S12.096 19.5 19 19.5c6.903 0 10-1.138 10-5.625"></path>
                    <path fill="#662113"
                          d="M16 12.4c0-1.857-.34-2.4-1.5-2.4s-1.5.543-1.5 2.4c0 1.856.34 2.399 1.5 2.399S16 14.256 16 12.4M25 12.4c0-1.857-.34-2.4-1.5-2.4s-1.5.543-1.5 2.4c0 1.856.34 2.399 1.5 2.399S25 14.256 25 12.4"></path>
                    <path fill="#292f33"
                          d="M10 20a2 2 0 1 0-4.001.001A2 2 0 0 0 10 20M32 20a2 2 0 1 0-4.001.001A2 2 0 0 0 32 20"></path>
                </g>
            </svg>
            <span th:if="${#locale.language == 'uk'}" id="selectedLanguage">UA</span>
            <span th:if="${#locale.language == 'ru'}" id="selectedLanguage">RU</span>
            <div class="language-list">
                <div class="lang-item">
                    <svg style="width:20px" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 30 20"
                         viewBox="0 0 30 20" id="ukraine-flag">
                        <rect width="30" height="20"></rect>
                        <rect width="28" height="9" x="1" y="1" fill="#005bbb"></rect>
                        <rect width="28" height="9" x="1" y="10" fill="#ffd500"></rect>
                    </svg>
                    <span id="uk_UA">UA</span>
                </div>
                <div class="lang-item">
                    <svg style="width:20px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 47.5 47.5" id="pig">
                        <defs>
                            <clipPath id="a">
                                <path d="M0 38h38V0H0v38Z"></path>
                            </clipPath>
                        </defs>
                        <g clip-path="url(#a)" transform="matrix(1.25 0 0 -1.25 0 47.5)">
                            <path fill="#f4abba"
                                  d="M35.193 23.67a6.01 6.01 0 0 1 1.02 1.28c1.685 2.853.269 10.292-.592 10.8-.696.411-5.53-1.05-8.246-3.132-2.499 1.497-5.344 2.381-8.375 2.381-3.022 0-5.856-.879-8.349-2.367-2.721 2.075-7.533 3.528-8.227 3.118-.861-.508-2.276-7.947-.592-10.8.278-.471.615-.884.989-1.249C1.665 21.149 1 18.359 1 15.521 1 5.531 9.01 2.999 19 2.999c9.989 0 18 2.532 18 12.522 0 2.827-.661 5.606-1.807 8.149"></path>
                            <path fill="#ea596e"
                                  d="M8.398 31.035c-2.166 1.268-4.402 2.08-4.8 1.845-.57-.336-1.083-4.998-.351-8.264a20.366 20.366 0 0 0 5.151 6.419M34.753 24.616c.732 3.267.219 7.928-.351 8.265-.398.235-2.634-.578-4.8-1.846a20.316 20.316 0 0 0 5.151-6.419M29 13.875C29 9.388 25.903 4.5 19 4.5c-6.904 0-10 4.888-10 9.375S12.096 19.5 19 19.5c6.903 0 10-1.138 10-5.625"></path>
                            <path fill="#662113"
                                  d="M16 12.4c0-1.857-.34-2.4-1.5-2.4s-1.5.543-1.5 2.4c0 1.856.34 2.399 1.5 2.399S16 14.256 16 12.4M25 12.4c0-1.857-.34-2.4-1.5-2.4s-1.5.543-1.5 2.4c0 1.856.34 2.399 1.5 2.399S25 14.256 25 12.4"></path>
                            <path fill="#292f33"
                                  d="M10 20a2 2 0 1 0-4.001.001A2 2 0 0 0 10 20M32 20a2 2 0 1 0-4.001.001A2 2 0 0 0 32 20"></path>
                        </g>
                    </svg>
                    <span id="ru_UA">RU</span>
                </div>
            </div>
        </div>
        <li class="dropdown notifications-menu" style="margin-right: 15px; margin-left: 7px;">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                <i class="fa fa-bell" id="bell" aria-hidden="true" style="color:grey;"></i>
            </a>
            <ul class="dropdown-menu">

                <li class="header" id="new_msg"
                    th:text="${owner.unreadMessageQuantity > 0} ? (#{newMessageQuant} + ' ' + ${owner.unreadMessageQuantity}): (#{noNewMessage})">
                    Нет новых сообщений
                </li>
                <li class="footer"><a th:href="@{/cabinet/messages}" th:text="#{toMessage}">Перейти в раздел
                    сообщений</a></li>
            </ul>
        </li>
        <!-- user panel  -->
        <li class="dropdown user user-menu" style="padding-top:5px;">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                    <img th:src="${owner.profile_picture != null && !owner.profile_picture.isEmpty()} ?
                                   @{${owner.profile_picture}} :  @{/images/placeholder.jpg}" class="user-image"
                         alt="User Image" style="margin-top:-4px;">
                <span class="hidden-xs" style="color:grey;" th:text="${owner.last_name + ' ' + owner.first_name }">Иванов Иван</span>
            </a>
            <ul class="dropdown-menu">
                <li class="user-header"
                    style="background-color: rgba(255,0,0,0.4); display:flex; flex-direction:column;
              justify-content:center;align-items:center;">
                    <div class="circular-image" style=" width: 130px; height: 130px;">
                        <img th:src="${owner.profile_picture != null && !owner.profile_picture.isEmpty()} ?
                                   @{${owner.profile_picture}} :  @{/images/placeholder.jpg}" alt="user-avatar"
                             class="img-circle img-fluid">
                    </div>
                    <p style="margin: 0">
                        <b th:text="${owner.last_name + ' ' + owner.first_name + ' ' + owner.fathers_name}">Иванов
                            Иван</b>
                    </p>
                </li>
                <li class="user-row" style="list-style: none; padding: 0; display: flex;">
                    <div style="flex: 1;">
                        <a th:href="@{/cabinet/user/view}" class="btn btn-warning" th:text="#{profile}">Профиль</a>
                    </div>
                    <div style="flex: 1; text-align: right;">
                        <a th:href="@{/cabinet/logout}" class="btn btn-danger" th:text="#{exit}" onclick="return confirmExit()">Выйти</a>

                    </div>
                </li>
            </ul>
        </li>
    </aside>
</nav>
<!-- /.navbar -->


<!-- Main Sidebar Container -->
<aside th:fragment="sidebar"
       class="main-sidebar sidebar-light-primary"
       style="color: #444444; font-weight: 600; box-shadow: none;">
    <!-- Brand Logo -->
    <a th:href="@{/cabinet}" class="brand-link" style="margin-bottom: 20px; padding: 3px;">
      <span class="logo-lg"><img th:src="@{/images/namelogo.png}" alt="AdminLTE Logo"
                                 class="img"
                                 style="opacity: .8; width:75%; margin-inline:15%;"></span>
        <span class="logo-mini"><img th:src="@{/images/logo-mini.svg}" alt="AdminLTE Logo"
                                     class="img"
                                     style="opacity: .8; width:75%; margin-left:10px;
                                          max-width:50px;max-height:50px;"></span>
    </a>
    <!-- Sidebar -->
    <div class="sidebar">
        <!-- Sidebar Menu -->
        <nav style="margin-top: 10px;">
            <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
                <!-- Add icons to the links using the .nav-icon class
                     with font-awesome or any other icon font library -->




                <li class="nav-item" th:classappend="${indexPageActive} ? 'menu-open'">
                    <a href="#" class="nav-link">
                        <i class="fa fa-line-chart" aria-hidden="true"></i>
                        <p class="pl-1" th:text="#{summary}">
                            Сводка
                        </p>
                        <i class="fas fa-angle-right right"></i>
                    </a>
                    <ul class="nav nav-treeview" th:styleappend="${indexPageActive} ? 'display:block'" th:if="${owner.apartments.size > 0}"
                        th:each="apartment : ${owner.apartments}" style="font-weight: 400">
                        <li class="nav-item dropdown-items">
                            <a th:href="@{/cabinet/{id}(id=${apartment.id})}" class="nav-link dropdown-links" th:classappend="${apartmentId == apartment.id} ? 'active'"
                               style="margin:0">
                                <i style="font-size: 16px;" class="fa fa-building-o fa-sm nav-icon"></i>
                                <p th:text="${apartment.building.name + ' кв. ' + apartment.number}"></p>
                            </a>
                        </li>
                    </ul>
                </li>





                <li class="nav-item" th:classappend="${invoicesPageActive} ? 'menu-open'">
                    <a href="#" class="nav-link">
                        <i class="fa fa-files-o" aria-hidden="true"></i>
                        <p class="pl-1" th:text="#{Invioces}">
                            Квитанции
                        </p>
                        <i class="fas fa-angle-right right"></i>
                    </a>
                    <ul class="nav nav-treeview" th:if="${owner.apartments.size > 0}" th:each="apartment, iterStat : ${owner.apartments}" th:styleappend="${invoicesPageActive} ? 'display:block'" style="font-weight: 400">
                        <li th:if="${iterStat.first}" class="nav-item dropdown-items">
                            <a th:href="@{/cabinet/invoices}" class="nav-link dropdown-links" th:classappend="${allInvoicesPageActive} ? 'active'" style="margin:0">
                                <i style="font-size: 16px;" class="fa fa-files-o fa-sm nav-icon"></i>
                                <p>Все квитанции</p>
                            </a>
                        </li>
                        <li class="nav-item dropdown-items">
                            <a th:href="@{/cabinet/invoices/{id}(id=${apartment.id})}" class="nav-link dropdown-links" th:classappend="${apartmentId == apartment.id} ? 'active'" style="margin:0">
                                <i style="font-size: 16px;" class="fa fa-building-o fa-sm nav-icon"></i>
                                <p th:text="${apartment.building.name + ' кв. '+ apartment.number}"></p>
                            </a>
                        </li>
                    </ul>
                </li>




                <li class="nav-item" th:classappend="${tariffsPageActive} ? 'menu-open'">
                    <a href="#" class="nav-link">
                        <i class="fa fa-money" aria-hidden="true"></i>
                        <p class="pl-1" th:text="#{tariffs}">
                            Тарифы
                            <i class="fas fa-angle-left right"></i>
                        </p>
                        <i class="fas fa-angle-right right"></i>
                    </a>
                    <ul class="nav nav-treeview" th:styleappend="${tariffsPageActive} ? 'display:block'" th:if=" ${owner.apartments.size>0}"
                        th:each="apartment : ${owner.apartments}" style="font-weight: 400">
                        <li class="nav-item dropdown-items">
                            <a th:href="@{/cabinet/tariffs/{id}(id=${apartment.id})}" class="nav-link dropdown-links" th:classappend="${apartmentId == apartment.id} ? 'active'"
                               style="margin:0">
                                <i style="font-size: 16px;" class="fa fa-building-o fa-sm nav-icon"></i>
                                <p th:text="${apartment.building.name + ' кв. '+ apartment.number}"></p>
                            </a>
                        </li>
                    </ul>
                </li>




                <li class="nav-item" >
                    <a th:href="@{/cabinet/messages}" class="nav-link" th:classappend="${messagesPageActive} ? 'active'">
                        <i class="fa fa-envelope-o" aria-hidden="true"></i>
                        <p class="pl-1" th:text="#{messages}">
                            Сообщения
                        </p>
                    </a>
                </li>

                <li class="nav-item" >
                    <a th:href="@{/cabinet/requests}" class="nav-link" th:classappend="${requestsPageActive} ? 'active'">
                        <i class="fa fa-wrench" aria-hidden="true"></i>
                        <p class="pl-1" th:text="#{requestMaster}">
                            Вызов мастера
                        </p>
                    </a>
                </li>

                <li class="nav-item" >
                    <a th:href="@{/cabinet/user/view}" class="nav-link" th:classappend="${profilePageActive} ? 'active'">
                        <i class="fa fa-user-circle" aria-hidden="true" style="font-size: 14px"></i>
                        <p class="pl-1" th:text="#{profile}">
                            Профиль
                        </p>
                    </a>
                </li>
            </ul>
        </nav>
        <!-- /.sidebar-menu -->
    </div>
    <script th:src="@{/plugins/jquery/jquery.min.js}"></script>

    <script>
        var unreadMessageQuantity = [[${owner.unreadMessageQuantity}]];
        var ownerId= [[${owner.id}]];
        let myLang = $(".my-lang");
        $(".lang-item").click(function () {
            let element = $(this).find('span');
            console.log(element.attr('id'));
            $("#selectedLanguage").text(element.text());
            document.getElementsByClassName("language-list")[0].style.display = 'none';

            const url = "/myhomecab/change-language";

            $.post(url, {language: element.attr('id')}, function (data) {
                console.log(data);
                location.reload();
            });
        });

    </script>
    <script th:inline="javascript">
        function confirmExit() {
            var confirmMessage = [[#{confirmExit}]];
            return confirm(confirmMessage);
        }
    </script>
    <style>

        .nav-link {
            padding-block: 12px;
            padding-left: 15px;
            padding-right: 5px;
        }

        .nav-treeview .nav-link {
            padding-block: 5px;
        }

        .nav-item i {
            width: 20px;
            font-size: 16px;
        }

        .nav-treeview {
            font-size: 14px;
        }

        .nav-treeview .nav-link:hover {
            color: black;
            background-color: rgba(128, 128, 128, 0.01) !important;
        }

    </style>
    <style>
        nav a {
            text-decoration: none;
        }

        .my-lang {
            display: flex;
            align-items: center;
            justify-content: center;
            column-gap: 5px;
            cursor: pointer;
            border: 1px solid silver;
            border-radius: 5px;
            padding: 3px;
            position: relative;
            width: 60px;
        }

        .dark-mode .my-lang {
            border: 1px solid gray;
        }

        .language-list {
            display: none;
            position: absolute;
            top: 100%;
            left: 0px;
            width: 58px;
            border: 1px solid silver;
            border-top: 1.2px solid black;
            background-color: white;
        }

        .dark-mode .language-list {
            background-color: #454d55;
        }

        .lang-item {
            padding: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            column-gap: 5px;
            width: 58px;
        }

        .lang-item:hover {
            font-weight: bold;
            background-color: lightgray;
        }

        .my-lang:hover .my-lang, .my-lang:hover .language-list {
            border: 1.2px solid black;
        }

        .my-lang:hover #selectedLanguage {
            font-weight: bold;
        }

        .my-lang:hover .language-list, .language-list:hover .language-list {
            display: block;
        }

        #selectedLanguage {
            font-family: Recursive;
            font-size: 16px;
        }
    </style>
    <!-- /.sidebar -->
</aside>


<!-- Main Footer -->
<footer th:fragment="footer" class="main-footer">
    <span th:text="#{footerP1}">Разработано </span> <a href="https://avada-media.ua" th:text="#{footerP2}">
    AVADA-MEDIA</a>.
    <span th:text="#{footerP3}">На базе системы управления </span> <a href="https://avada-media.ua/moydom24/"
                                                                      th:text="#{footerP4}"> "МойДом24"</a>.
    <span th:text="#{footerP5}">Документация API доступна по </span> <a href="http://myhouse24.avada-media.ua/doc"
                                                                        th:text="#{footerP6}"> ссылке</a>.
    <div class="float-right d-none d-sm-inline-block">
        <b>Version</b> 1.0.0
    </div>
</footer>
</div>
<!-- ./wrapper -->

